[
    {
        "id": "0008fcf0ac8e3fc4",
        "type": "tab",
        "label": "Main",
        "disabled": false,
        "info": "",
        "env": [
            {
                "name": "opc_endpoint",
                "value": "opc.tcp://150.162.14.27:4840",
                "type": "str"
            }
        ]
    },
    {
        "id": "1f735b7c1ec2a540",
        "type": "subflow",
        "name": "endpoint_discard_diverter_module",
        "info": "",
        "category": "",
        "in": [],
        "out": [],
        "env": [
            {
                "name": "node_id",
                "type": "str",
                "value": "ns=4;i=2"
            }
        ],
        "meta": {},
        "color": "#FFCC66",
        "icon": "font-awesome/fa-television"
    },
    {
        "id": "1a29c5eb11ee4ae1",
        "type": "subflow",
        "name": "Bad Request",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "d90610f48c819e2e"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "meta": {},
        "color": "#C7E9C0",
        "inputLabels": [
            "value"
        ],
        "icon": "node-red/alert.svg"
    },
    {
        "id": "e5b98768751d086a",
        "type": "subflow",
        "name": "Successful Post",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "485bba2c4636a4ea"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "meta": {},
        "color": "#C7E9C0",
        "inputLabels": [
            "value"
        ],
        "icon": "font-awesome/fa-check"
    },
    {
        "id": "dc1ef54720b3dae9",
        "type": "subflow",
        "name": "Successful Get",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "8efdc158c2053ade"
                    }
                ]
            }
        ],
        "out": [],
        "env": [],
        "meta": {},
        "color": "#C7E9C0",
        "inputLabels": [
            "value"
        ],
        "icon": "font-awesome/fa-check"
    },
    {
        "id": "14e0290e2bea4e8c",
        "type": "OpcUa-Endpoint",
        "endpoint": "opc.tcp://150.162.14.27:4840",
        "secpol": "None",
        "secmode": "None",
        "none": true,
        "login": false,
        "usercert": false,
        "usercertificate": "",
        "userprivatekey": ""
    },
    {
        "id": "c2fd6ea3cc083b70",
        "type": "OpcUa-Endpoint",
        "z": "1f735b7c1ec2a540",
        "endpoint": "${$parent.opc_endpoint}",
        "secpol": "None",
        "secmode": "None",
        "none": true,
        "login": false,
        "usercert": false,
        "usercertificate": "",
        "userprivatekey": ""
    },
    {
        "id": "69d845c11d15f13f",
        "type": "websocket-listener",
        "z": "1f735b7c1ec2a540",
        "path": "/ws/separating/discardDiverter",
        "wholemsg": "false"
    },
    {
        "id": "dbd529ba3fdb4f4e",
        "type": "websocket-client",
        "z": "1f735b7c1ec2a540",
        "path": "",
        "tls": "",
        "wholemsg": "false",
        "hb": "0",
        "subprotocol": "",
        "headers": []
    },
    {
        "id": "0b7991cfc665dd32",
        "type": "http in",
        "z": "1f735b7c1ec2a540",
        "name": "get status",
        "url": "/separating/discardDiverter",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 440,
        "y": 100,
        "wires": [
            [
                "a961b59b528f1362"
            ]
        ]
    },
    {
        "id": "a961b59b528f1362",
        "type": "OpcUa-Item",
        "z": "1f735b7c1ec2a540",
        "item": "${node_id}",
        "datatype": "Boolean",
        "value": "",
        "name": "",
        "x": 660,
        "y": 100,
        "wires": [
            [
                "17c7057090b2d153"
            ]
        ]
    },
    {
        "id": "17c7057090b2d153",
        "type": "OpcUa-Client",
        "z": "1f735b7c1ec2a540",
        "endpoint": "c2fd6ea3cc083b70",
        "action": "read",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "useTransport": false,
        "maxChunkCount": 1,
        "maxMessageSize": 8192,
        "receiveBufferSize": 8192,
        "sendBufferSize": 8192,
        "name": "Client Read",
        "x": 870,
        "y": 100,
        "wires": [
            [
                "ef9d28ae711ebb4e"
            ],
            []
        ]
    },
    {
        "id": "b3167a04a4347352",
        "type": "http in",
        "z": "1f735b7c1ec2a540",
        "name": "post status",
        "url": "/separating/discardDiverter",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 80,
        "y": 340,
        "wires": [
            [
                "4ae7398ac61c5732"
            ]
        ]
    },
    {
        "id": "60552216b3504c5a",
        "type": "comment",
        "z": "1f735b7c1ec2a540",
        "name": "recupera o estado do componente",
        "info": "OPC UA Cliente sempre retorna\num \"payload: 0\", independente do que é\npassado.\n\nAssim é feito um 'get' do estado\npara retornar se o estado do componente\nmudou de fato",
        "x": 1340,
        "y": 360,
        "wires": []
    },
    {
        "id": "31402a45caf73a3b",
        "type": "comment",
        "z": "1f735b7c1ec2a540",
        "name": "altera o estado do componente",
        "info": "",
        "x": 970,
        "y": 280,
        "wires": []
    },
    {
        "id": "4ae7398ac61c5732",
        "type": "function",
        "z": "1f735b7c1ec2a540",
        "name": "payload",
        "func": "msg.payload = msg.req.body.value;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 240,
        "y": 340,
        "wires": [
            [
                "c33f019dedc2ee5c"
            ]
        ]
    },
    {
        "id": "ab68424856c22849",
        "type": "switch",
        "z": "1f735b7c1ec2a540",
        "name": "validate",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 680,
        "y": 340,
        "wires": [
            [
                "5527d91086708f8f"
            ],
            [
                "5527d91086708f8f"
            ],
            [
                "4c38741330d8e4f4"
            ]
        ]
    },
    {
        "id": "4c38741330d8e4f4",
        "type": "subflow:1a29c5eb11ee4ae1",
        "z": "1f735b7c1ec2a540",
        "name": "Send Bad Request",
        "x": 970,
        "y": 440,
        "wires": []
    },
    {
        "id": "c33f019dedc2ee5c",
        "type": "function",
        "z": "1f735b7c1ec2a540",
        "name": "Transform to boolean",
        "func": "if (msg.payload == 0) {\n    msg.payload = false\n}\nif (msg.payload == 1) {\n    msg.payload = true\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 460,
        "y": 340,
        "wires": [
            [
                "ab68424856c22849"
            ]
        ]
    },
    {
        "id": "f65f540e7eb6936c",
        "type": "comment",
        "z": "1f735b7c1ec2a540",
        "name": "envia o resultado positivo para o cliente",
        "info": "",
        "x": 1630,
        "y": 480,
        "wires": []
    },
    {
        "id": "37f6bca919a33793",
        "type": "subflow:e5b98768751d086a",
        "z": "1f735b7c1ec2a540",
        "x": 1640,
        "y": 440,
        "wires": []
    },
    {
        "id": "5527d91086708f8f",
        "type": "OpcUa-Item",
        "z": "1f735b7c1ec2a540",
        "item": "${node_id}",
        "datatype": "Boolean",
        "value": "",
        "name": "",
        "x": 880,
        "y": 340,
        "wires": [
            [
                "0bb9fba15c901e17"
            ]
        ]
    },
    {
        "id": "0bb9fba15c901e17",
        "type": "OpcUa-Client",
        "z": "1f735b7c1ec2a540",
        "endpoint": "c2fd6ea3cc083b70",
        "action": "write",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "useTransport": false,
        "maxChunkCount": 1,
        "maxMessageSize": 8192,
        "receiveBufferSize": 8192,
        "sendBufferSize": 8192,
        "name": "Client Write",
        "x": 1050,
        "y": 340,
        "wires": [
            [
                "ee4a2ec4a3c6a9ec"
            ],
            []
        ]
    },
    {
        "id": "ee4a2ec4a3c6a9ec",
        "type": "OpcUa-Item",
        "z": "1f735b7c1ec2a540",
        "item": "${node_id}",
        "datatype": "Boolean",
        "value": "",
        "name": "",
        "x": 1260,
        "y": 400,
        "wires": [
            [
                "151f4ba59d3c52fa"
            ]
        ]
    },
    {
        "id": "151f4ba59d3c52fa",
        "type": "OpcUa-Client",
        "z": "1f735b7c1ec2a540",
        "endpoint": "c2fd6ea3cc083b70",
        "action": "read",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "useTransport": false,
        "maxChunkCount": 1,
        "maxMessageSize": 8192,
        "receiveBufferSize": 8192,
        "sendBufferSize": 8192,
        "name": "Client Read",
        "x": 1430,
        "y": 400,
        "wires": [
            [
                "37f6bca919a33793"
            ],
            []
        ]
    },
    {
        "id": "83ba442383dd061b",
        "type": "comment",
        "z": "1f735b7c1ec2a540",
        "name": "recupera o estado do componente",
        "info": "OPC UA Cliente sempre retorna\num \"payload: 0\", independente do que é\npassado.\n\nAssim é feito um 'get' do estado\npara retornar se o estado do componente\nmudou de fato",
        "x": 767.7777709960938,
        "y": 45.5555534362793,
        "wires": []
    },
    {
        "id": "ef9d28ae711ebb4e",
        "type": "subflow:dc1ef54720b3dae9",
        "z": "1f735b7c1ec2a540",
        "x": 1080,
        "y": 100,
        "wires": []
    },
    {
        "id": "b086d1fca168efa8",
        "type": "OpcUa-Item",
        "z": "1f735b7c1ec2a540",
        "item": "${node_id}",
        "datatype": "Boolean",
        "value": "",
        "name": "",
        "x": 740,
        "y": 580,
        "wires": [
            [
                "7d643f2ee3ab610a"
            ]
        ]
    },
    {
        "id": "7d643f2ee3ab610a",
        "type": "OpcUa-Client",
        "z": "1f735b7c1ec2a540",
        "endpoint": "c2fd6ea3cc083b70",
        "action": "subscribe",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": "1",
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "useTransport": false,
        "maxChunkCount": 1,
        "maxMessageSize": 8192,
        "receiveBufferSize": 8192,
        "sendBufferSize": 8192,
        "name": "Client Subscribe",
        "x": 960,
        "y": 580,
        "wires": [
            [
                "e6830508d6db9ef0"
            ],
            []
        ]
    },
    {
        "id": "395a1f6725999c1a",
        "type": "comment",
        "z": "1f735b7c1ec2a540",
        "name": "recupera o estado do componente",
        "info": "OPC UA Cliente sempre retorna\num \"payload: 0\", independente do que é\npassado.\n\nAssim é feito um 'get' do estado\npara retornar se o estado do componente\nmudou de fato",
        "x": 847.7777709960938,
        "y": 525.5555534362793,
        "wires": []
    },
    {
        "id": "e6830508d6db9ef0",
        "type": "websocket out",
        "z": "1f735b7c1ec2a540",
        "name": "",
        "server": "69d845c11d15f13f",
        "client": "",
        "x": 1220,
        "y": 580,
        "wires": []
    },
    {
        "id": "e4512e9f933ea44d",
        "type": "websocket in",
        "z": "1f735b7c1ec2a540",
        "name": "Subscribe on",
        "server": "69d845c11d15f13f",
        "client": "",
        "x": 70,
        "y": 600,
        "wires": [
            [
                "33500f3a8ceb48e6"
            ]
        ]
    },
    {
        "id": "a16205b60bddb11e",
        "type": "OpcUa-Item",
        "z": "1f735b7c1ec2a540",
        "item": "${node_id}",
        "datatype": "Boolean",
        "value": "",
        "name": "",
        "x": 740,
        "y": 640,
        "wires": [
            [
                "220dcbb6455d1977"
            ]
        ]
    },
    {
        "id": "220dcbb6455d1977",
        "type": "OpcUa-Client",
        "z": "1f735b7c1ec2a540",
        "endpoint": "c2fd6ea3cc083b70",
        "action": "unsubscribe",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": "1",
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "useTransport": false,
        "maxChunkCount": 1,
        "maxMessageSize": 8192,
        "receiveBufferSize": 8192,
        "sendBufferSize": 8192,
        "name": "Client Unsubscribe",
        "x": 970,
        "y": 640,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "33500f3a8ceb48e6",
        "type": "json",
        "z": "1f735b7c1ec2a540",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": true,
        "x": 230,
        "y": 600,
        "wires": [
            [
                "819ba519bbe9235d"
            ]
        ]
    },
    {
        "id": "819ba519bbe9235d",
        "type": "switch",
        "z": "1f735b7c1ec2a540",
        "name": "",
        "property": "payload.action",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "subscribe",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "unsubscribe",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "read",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "write",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 390,
        "y": 600,
        "wires": [
            [
                "b086d1fca168efa8"
            ],
            [
                "a16205b60bddb11e"
            ],
            [
                "eb08fa54eebe8311"
            ],
            [
                "b8b53ed4e2acfa62"
            ]
        ]
    },
    {
        "id": "eb08fa54eebe8311",
        "type": "OpcUa-Item",
        "z": "1f735b7c1ec2a540",
        "item": "${node_id}",
        "datatype": "Boolean",
        "value": "",
        "name": "",
        "x": 740,
        "y": 720,
        "wires": [
            [
                "4524420de44f08b5"
            ]
        ]
    },
    {
        "id": "4524420de44f08b5",
        "type": "OpcUa-Client",
        "z": "1f735b7c1ec2a540",
        "endpoint": "c2fd6ea3cc083b70",
        "action": "read",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "useTransport": false,
        "maxChunkCount": 1,
        "maxMessageSize": 8192,
        "receiveBufferSize": 8192,
        "sendBufferSize": 8192,
        "name": "Client Read",
        "x": 950,
        "y": 720,
        "wires": [
            [
                "912d7b42a69cf36e"
            ],
            []
        ]
    },
    {
        "id": "912d7b42a69cf36e",
        "type": "websocket out",
        "z": "1f735b7c1ec2a540",
        "name": "",
        "server": "69d845c11d15f13f",
        "client": "",
        "x": 1220,
        "y": 720,
        "wires": []
    },
    {
        "id": "6a8fd81d9764de4b",
        "type": "comment",
        "z": "1f735b7c1ec2a540",
        "name": "recupera o estado do componente",
        "info": "OPC UA Cliente sempre retorna\num \"payload: 0\", independente do que é\npassado.\n\nAssim é feito um 'get' do estado\npara retornar se o estado do componente\nmudou de fato",
        "x": 980,
        "y": 880,
        "wires": []
    },
    {
        "id": "bee9ca37e44f3bfd",
        "type": "comment",
        "z": "1f735b7c1ec2a540",
        "name": "altera o estado do componente",
        "info": "",
        "x": 610,
        "y": 800,
        "wires": []
    },
    {
        "id": "c3248d5dad5b911b",
        "type": "OpcUa-Item",
        "z": "1f735b7c1ec2a540",
        "item": "${node_id}",
        "datatype": "Boolean",
        "value": "",
        "name": "",
        "x": 520,
        "y": 860,
        "wires": [
            [
                "9907d2657fe35197"
            ]
        ]
    },
    {
        "id": "9907d2657fe35197",
        "type": "OpcUa-Client",
        "z": "1f735b7c1ec2a540",
        "endpoint": "c2fd6ea3cc083b70",
        "action": "write",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "useTransport": false,
        "maxChunkCount": 1,
        "maxMessageSize": 8192,
        "receiveBufferSize": 8192,
        "sendBufferSize": 8192,
        "name": "Client Write",
        "x": 690,
        "y": 860,
        "wires": [
            [
                "20791cb493f89336"
            ],
            []
        ]
    },
    {
        "id": "20791cb493f89336",
        "type": "OpcUa-Item",
        "z": "1f735b7c1ec2a540",
        "item": "${node_id}",
        "datatype": "Boolean",
        "value": "",
        "name": "",
        "x": 900,
        "y": 920,
        "wires": [
            [
                "d370d5b5323825b5"
            ]
        ]
    },
    {
        "id": "d370d5b5323825b5",
        "type": "OpcUa-Client",
        "z": "1f735b7c1ec2a540",
        "endpoint": "c2fd6ea3cc083b70",
        "action": "read",
        "deadbandtype": "a",
        "deadbandvalue": 1,
        "time": 10,
        "timeUnit": "s",
        "certificate": "n",
        "localfile": "",
        "localkeyfile": "",
        "securitymode": "None",
        "securitypolicy": "None",
        "useTransport": false,
        "maxChunkCount": 1,
        "maxMessageSize": 8192,
        "receiveBufferSize": 8192,
        "sendBufferSize": 8192,
        "name": "Client Read",
        "x": 1070,
        "y": 920,
        "wires": [
            [
                "92e32589be279c65"
            ],
            []
        ]
    },
    {
        "id": "b8b53ed4e2acfa62",
        "type": "change",
        "z": "1f735b7c1ec2a540",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.value",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 740,
        "wires": [
            [
                "c3248d5dad5b911b"
            ]
        ]
    },
    {
        "id": "92e32589be279c65",
        "type": "websocket out",
        "z": "1f735b7c1ec2a540",
        "name": "",
        "server": "69d845c11d15f13f",
        "client": "",
        "x": 1320,
        "y": 920,
        "wires": []
    },
    {
        "id": "6afc88ee26fba6ac",
        "type": "http response",
        "z": "1a29c5eb11ee4ae1",
        "name": "",
        "statusCode": "400",
        "headers": {},
        "x": 400,
        "y": 80,
        "wires": []
    },
    {
        "id": "d90610f48c819e2e",
        "type": "template",
        "z": "1a29c5eb11ee4ae1",
        "name": "Prepare Response",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{\n    \"value\": {{payload}},\n    \"message\": \"Valor não é do tipo esperado.\"\n}",
        "output": "json",
        "x": 230,
        "y": 80,
        "wires": [
            [
                "6afc88ee26fba6ac"
            ]
        ]
    },
    {
        "id": "df9b6ea2fda7202d",
        "type": "http response",
        "z": "e5b98768751d086a",
        "name": "",
        "statusCode": "202",
        "headers": {},
        "x": 420,
        "y": 80,
        "wires": []
    },
    {
        "id": "485bba2c4636a4ea",
        "type": "template",
        "z": "e5b98768751d086a",
        "name": "Prepare Response",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{\n    \"value\": {{payload}},\n    \"message\": \"Valor alterado com sucesso.\"\n}",
        "output": "json",
        "x": 230,
        "y": 80,
        "wires": [
            [
                "df9b6ea2fda7202d"
            ]
        ]
    },
    {
        "id": "08f42bf24c561626",
        "type": "http response",
        "z": "dc1ef54720b3dae9",
        "name": "",
        "statusCode": "200",
        "headers": {},
        "x": 420,
        "y": 80,
        "wires": []
    },
    {
        "id": "8efdc158c2053ade",
        "type": "template",
        "z": "dc1ef54720b3dae9",
        "name": "Prepare Response",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{\n    \"value\": {{payload}},\n    \"message\": \"Valor obtido com sucesso.\"\n}",
        "output": "json",
        "x": 230,
        "y": 80,
        "wires": [
            [
                "08f42bf24c561626"
            ]
        ]
    },
    {
        "id": "bc5bf8f6432d32df",
        "type": "subflow:1f735b7c1ec2a540",
        "z": "0008fcf0ac8e3fc4",
        "name": "endpoint_discard_diverter_module",
        "x": 400,
        "y": 340,
        "wires": []
    }
]